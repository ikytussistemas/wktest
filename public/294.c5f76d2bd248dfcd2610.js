(self.webpackChunkwktest=self.webpackChunkwktest||[]).push([[294],{6294:(t,e,o)=>{"use strict";o.r(e),o.d(e,{OrdersModule:()=>V});var n=o(8583),i=o(4726),r=o(5642),a=o(240),s=o(6304),c=o(665),d=o(5257),l=o(4092),u=o(2633),p=o(7716),m=o(2609);let g=(()=>{class t extends m.M{constructor(t){super(t,"orders"),this.injector=t}}return t.\u0275fac=function(e){return new(e||t)(p.LFG(p.zs3))},t.\u0275prov=p.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var f=o(9281),Z=o(4554),b=o(5609),h=o(773),v=o(3922);function q(t,e){if(1&t){const t=p.EpF();p.TgZ(0,"button",12),p.NdJ("click",function(){return p.CHM(t),p.oxw().save()}),p._uU(1," Salvar "),p.qZA()}}const T=[[["","body",""]]],A=function(t){return{display:t}},y=["[body]"];let x=(()=>{class t{constructor(t){this.toast=t,this.isBtnSave=!0,this.fnSave=new p.vpe,this.display="none"}open(){this.display="block"}onCloseHandled(){this.display="none"}save(){this.fnSave.emit("")}}return t.\u0275fac=function(e){return new(e||t)(p.Y36(v.k))},t.\u0275cmp=p.Xpm({type:t,selectors:[["app-modal"]],inputs:{title:"title",isBtnSave:"isBtnSave"},outputs:{fnSave:"fnSave"},ngContentSelectors:y,decls:16,vars:8,consts:[[1,"backdrop",3,"ngStyle"],["tabindex","-1","role","dialog",1,"modal",3,"ngStyle"],["role","document",1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"modal-footer"],["data-dismiss","modal","type","button","class","btn btn-sm btn-success btn-block",3,"click",4,"ngIf"],["type","button",1,"btn","btn-default",3,"click"],["data-dismiss","modal","type","button",1,"btn","btn-sm","btn-success","btn-block",3,"click"]],template:function(t,e){1&t&&(p.F$t(T),p._UZ(0,"div",0),p.TgZ(1,"div",1),p.TgZ(2,"div",2),p.TgZ(3,"div",3),p.TgZ(4,"div",4),p.TgZ(5,"h4",5),p._uU(6),p.qZA(),p.TgZ(7,"button",6),p.NdJ("click",function(){return e.onCloseHandled()}),p.TgZ(8,"span",7),p._uU(9,"\xd7"),p.qZA(),p.qZA(),p.qZA(),p.TgZ(10,"div",8),p.Hsn(11),p.qZA(),p.TgZ(12,"div",9),p.YNc(13,q,2,0,"button",10),p.TgZ(14,"button",11),p.NdJ("click",function(){return e.onCloseHandled()}),p._uU(15,"Close"),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA()),2&t&&(p.Q6J("ngStyle",p.VKq(4,A,e.display)),p.xp6(1),p.Q6J("ngStyle",p.VKq(6,A,e.display)),p.xp6(5),p.Oqu(e.title),p.xp6(7),p.Q6J("ngIf",e.isBtnSave))},directives:[n.PC,n.O5],styles:[".backdrop[_ngcontent-%COMP%]{background-color:#0009;position:fixed;top:0;left:0;width:100%;height:100vh;z-index:998}.modal[_ngcontent-%COMP%]{z-index:999}.modal-header[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:space-between}.modal-content[_ngcontent-%COMP%]{max-width:900px}@media (min-width: 576px){.modal-dialog[_ngcontent-%COMP%]{max-width:900px;max-height:700px;margin:1.75rem auto}}"]}),t})();const C=["modal"];function _(t,e){if(1&t&&(p.TgZ(0,"option",16),p._uU(1),p.qZA()),2&t){const t=e.$implicit;p.Q6J("ngValue",t),p.xp6(1),p.Oqu(t.name)}}let k=(()=>{class t{constructor(t){this.productService=t,this.fnSave=new p.vpe,this.products=[],this.product={id:null,name:"",value:0}}ngOnInit(){this.getProdcts(),this.iten={product:this.product,quantity:0,amount:0}}open(){this.modal.open()}getProdcts(){this.productService.getList().pipe((0,d.q)(1)).subscribe(t=>{this.products=t.map(t=>Object.assign({id:t.payload.doc.id},t.payload.doc.data()))})}setIten(t){this.iten=t,this.product=t.product,this.open()}refreshItem(){this.iten.product=this.product}refreshValues(){this.iten.amount=this.iten.product.value*this.iten.quantity}checkProduct(t,e){return t&&e?t.name===e.name&&t.id===e.id:t===e}save(){this.fnSave.emit(this.iten),this.iten={product:this.product,quantity:0,amount:0},this.modal.onCloseHandled()}}return t.\u0275fac=function(e){return new(e||t)(p.Y36(h.M))},t.\u0275cmp=p.Xpm({type:t,selectors:[["app-itens-modal"]],viewQuery:function(t,e){if(1&t&&p.Gf(C,5),2&t){let t;p.iGM(t=p.CRH())&&(e.modal=t.first)}},outputs:{fnSave:"fnSave"},decls:26,vars:6,consts:[["title","Produtos",3,"fnSave"],["modal",""],["body",""],[1,"col-sm-12"],[1,"row"],[1,"col-sm-12","col-md-3"],[1,"form-group"],["for","product"],["id","product",3,"ngModel","compareWith","ngModelChange","change"],[3,"ngValue",4,"ngFor","ngForOf"],["for","vrUnit"],["id","vrUnit","type","number",3,"ngModel","ngModelChange","change"],["for","qtd"],["id","qtd","type","number",3,"ngModel","ngModelChange","change"],["for","amount"],["id","amount","type","number","disabled","",3,"ngModel","ngModelChange"],[3,"ngValue"]],template:function(t,e){1&t&&(p.TgZ(0,"app-modal",0,1),p.NdJ("fnSave",function(){return e.save()}),p.TgZ(2,"div",2),p.TgZ(3,"div",3),p.TgZ(4,"div",4),p.TgZ(5,"div",5),p.TgZ(6,"div",6),p.TgZ(7,"label",7),p._uU(8,"Produto:"),p.qZA(),p.TgZ(9,"select",8),p.NdJ("ngModelChange",function(t){return e.product=t})("change",function(){return e.refreshItem()}),p.YNc(10,_,2,2,"option",9),p.qZA(),p.qZA(),p.qZA(),p.TgZ(11,"div",5),p.TgZ(12,"div",6),p.TgZ(13,"label",10),p._uU(14,"Vr Unit\xe1rio:"),p.qZA(),p.TgZ(15,"input",11),p.NdJ("ngModelChange",function(t){return e.product.value=t})("change",function(){return e.refreshValues()}),p.qZA(),p.qZA(),p.qZA(),p.TgZ(16,"div",5),p.TgZ(17,"div",6),p.TgZ(18,"label",12),p._uU(19,"Quantidade:"),p.qZA(),p.TgZ(20,"input",13),p.NdJ("ngModelChange",function(t){return e.iten.quantity=t})("change",function(){return e.refreshValues()}),p.qZA(),p.qZA(),p.qZA(),p.TgZ(21,"div",5),p.TgZ(22,"div",6),p.TgZ(23,"label",14),p._uU(24,"Total:"),p.qZA(),p.TgZ(25,"input",15),p.NdJ("ngModelChange",function(t){return e.iten.amount=t}),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA()),2&t&&(p.xp6(9),p.Q6J("ngModel",e.product)("compareWith",e.checkProduct),p.xp6(1),p.Q6J("ngForOf",e.products),p.xp6(5),p.Q6J("ngModel",e.product.value),p.xp6(5),p.Q6J("ngModel",e.iten.quantity),p.xp6(5),p.Q6J("ngModel",e.iten.amount))},directives:[x,c.EJ,c.JJ,c.On,n.sg,c.wV,c.Fj,c.YN,c.Kr],styles:[".row[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;align-items:center}"]}),t})();var U=o(5574),M=o(8638),w=o(2860);const J=["modalProducts"];function I(t,e){if(1&t){const t=p.EpF();p.TgZ(0,"form",22),p.NdJ("ngSubmit",function(e){return p.CHM(t),p.oxw().onSubmit(),e.preventDefault()}),p.TgZ(1,"div",23),p.TgZ(2,"div",24),p.TgZ(3,"div",25),p.TgZ(4,"div",26),p.TgZ(5,"label",27),p._uU(6,"C\xf3digo"),p.qZA(),p._UZ(7,"input",28),p._UZ(8,"valid-msg",29),p.qZA(),p.qZA(),p.TgZ(9,"div",30),p.TgZ(10,"div",26),p.TgZ(11,"label",31),p._uU(12,"Data/Hora"),p.qZA(),p._UZ(13,"input",32),p._UZ(14,"valid-msg",29),p.qZA(),p.qZA(),p.TgZ(15,"div",33),p.TgZ(16,"div",34),p.TgZ(17,"label",35),p._uU(18,"Cliente"),p.qZA(),p._UZ(19,"input",36),p.qZA(),p._UZ(20,"valid-msg",29),p.qZA(),p.TgZ(21,"div",37),p.TgZ(22,"div",26),p.TgZ(23,"label",38),p._uU(24,"Total do Pedido"),p.qZA(),p._UZ(25,"input",39),p._UZ(26,"valid-msg",29),p.qZA(),p.qZA(),p.qZA(),p._UZ(27,"hr",40),p.qZA(),p._UZ(28,"toolbar-edit",41),p.qZA()}if(2&t){const t=p.oxw();p.Q6J("formGroup",t.formulario),p.xp6(8),p.Q6J("control",t.formulario.controls.cod),p.xp6(6),p.Q6J("control",t.formulario.controls.time),p.xp6(6),p.Q6J("control",t.formulario.controls.customer),p.xp6(6),p.Q6J("control",t.formulario.controls.amount),p.xp6(2),p.Q6J("formulario",t.formulario)}}function O(t,e){if(1&t){const t=p.EpF();p.TgZ(0,"a",47),p.TgZ(1,"button",48),p.NdJ("click",function(){const e=p.CHM(t).$implicit,o=p.oxw().$implicit;return e.eventHandler(o)}),p.qZA(),p.qZA()}if(2&t){const t=e.$implicit;p.xp6(1),p.MT6("btn btn-",t.color," btn-pdr fa fa-",t.icon||"plus"," sombra-btn"),p.s9C("title",t.title)}}function P(t,e){if(1&t&&(p.TgZ(0,"tr"),p.TgZ(1,"td",42),p._uU(2),p.qZA(),p.TgZ(3,"td",43),p._uU(4),p.qZA(),p.TgZ(5,"td",44),p._uU(6),p.ALo(7,"customPipe"),p.qZA(),p.TgZ(8,"td",45),p._uU(9),p.ALo(10,"customPipe"),p.qZA(),p.TgZ(11,"td"),p.YNc(12,O,2,5,"a",46),p.qZA(),p.qZA()),2&t){const t=e.$implicit,o=p.oxw();p.xp6(2),p.Oqu((null==t.product?null:t.product.name)||""),p.xp6(2),p.Oqu(t.quantity||0),p.xp6(2),p.Oqu(p.xi3(7,5,(null==t.product?null:t.product.value)||0,"currency")),p.xp6(3),p.Oqu(p.xi3(10,8,t.amount||0,"currency")),p.xp6(3),p.Q6J("ngForOf",o.tableOptions.buttons)}}function N(t,e){if(1&t&&(p.TgZ(0,"td",49),p._uU(1),p.qZA()),2&t){const t=p.oxw();p.xp6(1),p.hij(" ",t.tableOptions.emptyMessage,"")}}let S=(()=>{class t extends l.R{constructor(t,e,o){super(t,e,"orders","/orders"),this.injector=t,this.orderService=e,this.customerService=o,this.customer={id:null,address:null,birthday:null,cpf:"",email:"",name:""},this.itens=[],this.tableOptions={entity:this.itens,fields:[{name:"name",label:"Nome",pipe:"uppercase"},{name:"email",label:"E-mail",pipe:"lowerCase"},{name:"cpf",label:"CPF"}],headers:["Nome","E-mail","CPF"],emptyMessage:"Nenhum Registro encontrado",buttons:[{eventHandler:t=>this.goToEdit(t),title:"Editar",color:u.s.PRIMARY,icon:u.E.EDIT},{eventHandler:t=>this.removeIten(t),title:"Deletar",color:u.s.DANGER,icon:u.E.TRASH}]}}formConstructorById(){var t=this;return(0,s.Z)(function*(){return t.formBuilder.group({id:[t.object.id],cod:[{value:t.object.cod,disabled:!0},[c.kI.required,c.kI.minLength(3)]],time:[{value:t.object.time,disabled:!0}],customer:t.formBuilder.group({id:[t.object.customer.id],name:[{value:t.object.customer.name,disabled:!0},[c.kI.required,c.kI.minLength(3)]],email:[t.object.customer.email,[c.kI.required,c.kI.email]],cpf:[t.object.customer.cpf,[c.kI.required]],birthday:[new Date(t.object.customer.birthday).toISOString().substr(0,10)]}),products:[t.object.products],amount:[t.object.amount]})})()}formConstructorNew(){var t=this;return(0,s.Z)(function*(){return t.formBuilder.group({id:[null],cod:[{value:(new Date).valueOf(),disabled:!0},[c.kI.required,c.kI.minLength(3)]],time:[{value:`${(new Date).toISOString().substr(0,10)} - ${(new Date).getHours()}:${(new Date).getMinutes()}`,disabled:!0}],customer:t.formBuilder.group({id:[""],name:[{value:"",disabled:!0},[c.kI.required,c.kI.minLength(3)]],email:["",[c.kI.required,c.kI.email]],cpf:["",[c.kI.required]],birthday:[""]}),products:[[]],amount:[0]})})()}guardListAttrib(){var t=this;return(0,s.Z)(function*(){t.customer=t.object.customer,t.itens=t.object.products})()}returnListAttrib(){var t=this;return(0,s.Z)(function*(){t.object.customer=t.customer,t.object.products=t.itens})()}findCustomerByCpf(t){this.customerService.getByCPF(t).pipe((0,d.q)(1)).subscribe(t=>{this.customer=t[0],this.formulario.patchValue({customer:this.customer})})}goToEdit(t){this.modalproducts.setIten(t),this.removeIten(t)}openModalProduct(){this.modalproducts.open()}addIten(t){this.itens.push(t),this.refreshItens(this.itens)}removeIten(t){this.itens.splice(this.itens.indexOf(this.checkIten(t)),1),this.refreshItens(this.itens)}checkIten(t){return this.itens.find(e=>e.product.id===t.product.id)}refreshItens(t){let e=0;for(let o of t)e+=o.amount;this.formulario.patchValue({amount:e}),this.onSubmit()}}return t.\u0275fac=function(e){return new(e||t)(p.Y36(p.zs3),p.Y36(g),p.Y36(f.v))},t.\u0275cmp=p.Xpm({type:t,selectors:[["app-order-edit"]],viewQuery:function(t,e){if(1&t&&p.Gf(J,5),2&t){let t;p.iGM(t=p.CRH())&&(e.modalproducts=t.first)}},features:[p.qOj],decls:47,vars:4,consts:[[1,"card"],[1,"page-top","shadow-sm"],["title","voltar",1,"btn","btn-warning","btn-xs","btn-pdr","fas","fa-arrow-circle-left","float-right","sombra-btn",3,"click"],[1,"card-body"],["itens","",1,"search"],["for","cpf",1,"searchLabel"],["id","cpf","type","text","IkMask","999.999.999-99",1,"border-r","border-l"],["cpf",""],[1,"btn","btn-primary",3,"click"],[1,"fas","fa-search"],["id","nome","type","text","disabled","",1,"border-r","border-l",3,"ngModel","ngModelChange"],["itens","",1,"col-xs-12","col-md-12"],[3,"formGroup","ngSubmit",4,"ngIf"],["itens",""],[1,"options"],[1,"fas","fa-receipt"],[1,"scrolling"],[1,"table","table-striped","table-bordered","table-sm"],[4,"ngFor","ngForOf"],["colspan","5","class","table-message-empty",4,"ngIf"],[3,"fnSave"],["modalProducts",""],[3,"formGroup","ngSubmit"],[1,"col-xs-12"],[1,"row"],[1,"col-sm-12","col-md-3"],[1,"form-group"],["for","cod"],["id","cod","type","text","formControlName","cod","IkUpCase","",1,"form-control"],[3,"control"],[1,"col-xs-12","col-md-3"],["for","time"],["id","time","type","text","formControlName","time",1,"form-control"],[1,"col-xs-12","col-md-4"],["formGroupName","customer",1,"form-group"],["for","customer"],["id","customer","type","text","formControlName","name",1,"form-control"],[1,"col-xs-12","col-md-2"],["for","amount"],["id","amount","type","number","formControlName","amount",1,"form-control"],[2,"margin","2px"],[3,"formulario"],["attr.data-label","Produto"],["attr.data-label","Quantidade"],["attr.data-label","Vr_Unit\xe1rio"],["attr.data-label","Total"],["class","componenteform",4,"ngFor","ngForOf"],[1,"componenteform"],["type","button","data-placement","bottom",3,"title","click"],["colspan","5",1,"table-message-empty"]],template:function(t,e){if(1&t){const t=p.EpF();p.TgZ(0,"div",0),p.TgZ(1,"div",1),p._uU(2," Cadastro de Pedido "),p.TgZ(3,"button",2),p.NdJ("click",function(){return e.return()}),p.qZA(),p.qZA(),p.TgZ(4,"div",3),p.TgZ(5,"toolbar-base"),p.TgZ(6,"div",4),p.TgZ(7,"label",5),p._uU(8,"CPF:"),p.qZA(),p._UZ(9,"input",6,7),p.TgZ(11,"button",8),p.NdJ("click",function(){p.CHM(t);const o=p.MAs(10);return e.findCustomerByCpf(o.value)}),p._UZ(12,"i",9),p.qZA(),p.TgZ(13,"label",5),p._uU(14,"Cliente:"),p.qZA(),p.TgZ(15,"input",10),p.NdJ("ngModelChange",function(t){return e.customer.name=t}),p.qZA(),p.qZA(),p.qZA(),p._UZ(16,"hr"),p.TgZ(17,"toolbar-base"),p.TgZ(18,"div",11),p.YNc(19,I,29,6,"form",12),p.qZA(),p.qZA(),p._UZ(20,"hr"),p.TgZ(21,"toolbar-base"),p.TgZ(22,"div",13),p.TgZ(23,"div",14),p.TgZ(24,"button",8),p.NdJ("click",function(){return e.openModalProduct()}),p._uU(25," Novo Item "),p._UZ(26,"i",15),p.qZA(),p.qZA(),p.TgZ(27,"div",16),p.TgZ(28,"table",17),p.TgZ(29,"thead"),p.TgZ(30,"tr"),p.TgZ(31,"th"),p._uU(32,"Produto"),p.qZA(),p.TgZ(33,"th"),p._uU(34,"Quantidade"),p.qZA(),p.TgZ(35,"th"),p._uU(36,"Vr_Unit"),p.qZA(),p.TgZ(37,"th"),p._uU(38,"Vr_Total"),p.qZA(),p.TgZ(39,"th"),p._uU(40,"Op\xe7\xf5es"),p.qZA(),p.qZA(),p.qZA(),p.TgZ(41,"tbody"),p.YNc(42,P,13,11,"tr",18),p.TgZ(43,"tr"),p.YNc(44,N,2,1,"td",19),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.TgZ(45,"app-itens-modal",20,21),p.NdJ("fnSave",function(t){return e.addIten(t)}),p.qZA()}2&t&&(p.xp6(15),p.Q6J("ngModel",e.customer.name),p.xp6(4),p.Q6J("ngIf",void 0!==e.formulario),p.xp6(23),p.Q6J("ngForOf",e.itens),p.xp6(2),p.Q6J("ngIf",e.itens.length<1))},directives:[Z.T,b.J,c.Fj,c.JJ,c.On,n.O5,n.sg,k,c._Y,c.JL,c.sg,c.u,U.p,c.x0,c.wV,M.Z],pipes:[w.G],styles:[".search[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;align-items:center}.searchLabel[_ngcontent-%COMP%]{font-weight:700}.options[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;align-items:center}"]}),t})();var j=o(7883),Q=o(8104),F=o(9767);let H=(()=>{class t extends j.${constructor(t,e){super(t,e,"time"),this.inject=t,this.orderService=e,this.tableOptions={entity:this.list,fields:[{name:"cod",label:"C\xf3digo"},{name:"time",label:"Data / Hora"},{name:"customer",sub:"name",label:"Cliente"},{name:"amount",label:"Valor do Pedido",pipe:"currency"}],headers:["C\xf3digo","Data/Hora","Cliente","Valor do Pedido"],emptyMessage:"Nenhum registro encontrado",buttons:[{eventHandler:t=>this.goToEdit(t.id),title:"Editar",color:u.s.PRIMARY,icon:u.E.EDIT},{eventHandler:t=>this.openModalDelete(t.id,t.name),title:"Deletar",color:u.s.DANGER,icon:u.E.TRASH}]}}goToEdit(t){this.router.navigate([`/orders/${t}/edit`])}}return t.\u0275fac=function(e){return new(e||t)(p.Y36(p.zs3),p.Y36(g))},t.\u0275cmp=p.Xpm({type:t,selectors:[["app-order-list"]],features:[p.qOj],decls:3,vars:4,consts:[["titletop","Pedidos Cadastrados","entity","list"],["body",""],[3,"tableOptions","entity","lastObject","page","fnNext","fnPrev","fnList"]],template:function(t,e){1&t&&(p.TgZ(0,"base-layout",0),p.TgZ(1,"div",1),p.TgZ(2,"app-table",2),p.NdJ("fnNext",function(){return e.nextPage()})("fnPrev",function(){return e.prevPage()})("fnList",function(t){return e.countPage(t)}),p.qZA(),p.qZA(),p.qZA()),2&t&&(p.xp6(2),p.Q6J("tableOptions",e.tableOptions)("entity",e.list)("lastObject",e.lastObject)("page",e.page))},directives:[Q.i,F.a],styles:[""]}),t})();const E=[{path:"",component:(()=>{class t{constructor(t){this.router=t}ngOnInit(){}goTo(t){this.router.navigate([`/orders/${t}`])}}return t.\u0275fac=function(e){return new(e||t)(p.Y36(a.F0))},t.\u0275cmp=p.Xpm({type:t,selectors:[["app-order-menu"]],decls:6,vars:0,consts:[[1,"card"],[1,"card-body"],[1,"btn","btn-block","btn-success",3,"click"],[1,"btn","btn-block","btn-warning",3,"click"]],template:function(t,e){1&t&&(p.TgZ(0,"div",0),p.TgZ(1,"div",1),p.TgZ(2,"button",2),p.NdJ("click",function(){return e.goTo("list")}),p._uU(3,"Pedidos Cadastrados"),p.qZA(),p.TgZ(4,"button",3),p.NdJ("click",function(){return e.goTo("../0/add")}),p._uU(5,"Novo Pedido"),p.qZA(),p.qZA(),p.qZA())},styles:[""]}),t})()},{path:"list",component:H},{path:"list/:id/add",component:S},{path:":id/add",component:S},{path:":id/edit",component:S}];let Y=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=p.oAB({type:t}),t.\u0275inj=p.cJS({imports:[[a.Bz.forChild(E)],a.Bz]}),t})(),V=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=p.oAB({type:t}),t.\u0275inj=p.cJS({imports:[[i.p,r.K,n.ez,Y]]}),t})()}}]);