(self.webpackChunkwktest=self.webpackChunkwktest||[]).push([[294],{6294:(t,e,o)=>{"use strict";o.r(e),o.d(e,{OrdersModule:()=>B});var n=o(8583),i=o(240),r=o(7716);let a=(()=>{class t{constructor(t){this.router=t}ngOnInit(){}goTo(t){this.router.navigate([`/orders/${t}`])}}return t.\u0275fac=function(e){return new(e||t)(r.Y36(i.F0))},t.\u0275cmp=r.Xpm({type:t,selectors:[["app-order-menu"]],decls:6,vars:0,consts:[[1,"card"],[1,"card-body"],[1,"btn","btn-block","btn-success",3,"click"],[1,"btn","btn-block","btn-warning",3,"click"]],template:function(t,e){1&t&&(r.TgZ(0,"div",0),r.TgZ(1,"div",1),r.TgZ(2,"button",2),r.NdJ("click",function(){return e.goTo("list")}),r._uU(3,"Pedidos Cadastrados"),r.qZA(),r.TgZ(4,"button",3),r.NdJ("click",function(){return e.goTo("../0/add")}),r._uU(5,"Novo Pedido"),r.qZA(),r.qZA(),r.qZA())},styles:[""]}),t})();var s=o(2633),d=o(7883),l=o(2609);let c=(()=>{class t extends l.M{constructor(t){super(t,"orders"),this.injector=t}}return t.\u0275fac=function(e){return new(e||t)(r.LFG(r.zs3))},t.\u0275prov=r.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var u=o(8104),p=o(9767);let m=(()=>{class t extends d.${constructor(t,e){super(t,e,"time"),this.inject=t,this.orderService=e,this.toolbarOptions={emptyMessage:"teste"},this.tableOptions={entity:this.list,fields:[{name:"cod",label:"C\xf3digo"},{name:"time",label:"Data / Hora"},{name:"customer",sub:"name",label:"Cliente"},{name:"amount",label:"Valor do Pedido",pipe:"currency"}],headers:["C\xf3digo","Data/Hora","Cliente","Valor do Pedido"],emptyMessage:"Nenhum registro encontrado",buttons:[{eventHandler:t=>this.goToEdit(t.id),title:"Editar",color:s.s.PRIMARY,icon:s.E.EDIT},{eventHandler:t=>this.openModalDelete(t.id,t.name),title:"Deletar",color:s.s.DANGER,icon:s.E.TRASH}]}}goToEdit(t){this.router.navigate([`/orders/${t}/edit`])}filtrar(t){}}return t.\u0275fac=function(e){return new(e||t)(r.Y36(r.zs3),r.Y36(c))},t.\u0275cmp=r.Xpm({type:t,selectors:[["app-order-list"]],features:[r.qOj],decls:3,vars:4,consts:[["titletop","Pedidos Cadastrados","entity","list"],["body","",1,"scrolling"],[3,"tableOptions","entity","lastObject","page","fnNext","fnPrev"]],template:function(t,e){1&t&&(r.TgZ(0,"base-layout",0),r.TgZ(1,"div",1),r.TgZ(2,"app-table",2),r.NdJ("fnNext",function(){return e.nextPage()})("fnPrev",function(){return e.prevPage()}),r.qZA(),r.qZA(),r.qZA()),2&t&&(r.xp6(2),r.Q6J("tableOptions",e.tableOptions)("entity",e.list)("lastObject",e.lastObject)("page",e.page))},directives:[u.i,p.a],styles:[""]}),t})();var g=o(6304),f=o(665),Z=o(4092),b=o(5257),h=o(9281),v=o(4554),q=o(5609),T=o(773),A=o(3922);function y(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"button",12),r.NdJ("click",function(){return r.CHM(t),r.oxw().save()}),r._uU(1," Salvar "),r.qZA()}}const x=[[["","body",""]]],C=function(t){return{display:t}},_=["[body]"];let k=(()=>{class t{constructor(t){this.toast=t,this.isBtnSave=!0,this.fnSave=new r.vpe,this.display="none"}open(){this.display="block"}onCloseHandled(){this.display="none"}save(){this.fnSave.emit("")}}return t.\u0275fac=function(e){return new(e||t)(r.Y36(A.k))},t.\u0275cmp=r.Xpm({type:t,selectors:[["app-modal"]],inputs:{title:"title",isBtnSave:"isBtnSave"},outputs:{fnSave:"fnSave"},ngContentSelectors:_,decls:16,vars:8,consts:[[1,"backdrop",3,"ngStyle"],["tabindex","-1","role","dialog",1,"modal",3,"ngStyle"],["role","document",1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"modal-footer"],["data-dismiss","modal","type","button","class","btn btn-sm btn-success btn-block",3,"click",4,"ngIf"],["type","button",1,"btn","btn-default",3,"click"],["data-dismiss","modal","type","button",1,"btn","btn-sm","btn-success","btn-block",3,"click"]],template:function(t,e){1&t&&(r.F$t(x),r._UZ(0,"div",0),r.TgZ(1,"div",1),r.TgZ(2,"div",2),r.TgZ(3,"div",3),r.TgZ(4,"div",4),r.TgZ(5,"h4",5),r._uU(6),r.qZA(),r.TgZ(7,"button",6),r.NdJ("click",function(){return e.onCloseHandled()}),r.TgZ(8,"span",7),r._uU(9,"\xd7"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(10,"div",8),r.Hsn(11),r.qZA(),r.TgZ(12,"div",9),r.YNc(13,y,2,0,"button",10),r.TgZ(14,"button",11),r.NdJ("click",function(){return e.onCloseHandled()}),r._uU(15,"Close"),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA()),2&t&&(r.Q6J("ngStyle",r.VKq(4,C,e.display)),r.xp6(1),r.Q6J("ngStyle",r.VKq(6,C,e.display)),r.xp6(5),r.Oqu(e.title),r.xp6(7),r.Q6J("ngIf",e.isBtnSave))},directives:[n.PC,n.O5],styles:[".backdrop[_ngcontent-%COMP%]{background-color:#0009;position:fixed;top:0;left:0;width:100%;height:100vh;z-index:998}.modal[_ngcontent-%COMP%]{z-index:999}.modal-header[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:space-between}.modal-content[_ngcontent-%COMP%]{max-width:900px}@media (min-width: 576px){.modal-dialog[_ngcontent-%COMP%]{max-width:900px;max-height:700px;margin:1.75rem auto}}"]}),t})();const M=["modal"];function U(t,e){if(1&t&&(r.TgZ(0,"option",16),r._uU(1),r.qZA()),2&t){const t=e.$implicit;r.Q6J("ngValue",t),r.xp6(1),r.Oqu(t.name)}}let w=(()=>{class t{constructor(t){this.productService=t,this.fnSave=new r.vpe,this.products=[],this.product={id:null,name:"",value:0}}ngOnInit(){this.getProdcts(),this.iten={product:this.product,quantity:0,amount:0}}open(){this.modal.open()}getProdcts(){this.productService.getList().pipe((0,b.q)(1)).subscribe(t=>{this.products=t.map(t=>Object.assign({id:t.payload.doc.id},t.payload.doc.data()))})}refreshItem(){this.iten.product=this.product}refreshValues(){this.iten.amount=this.iten.product.value*this.iten.quantity}save(){this.fnSave.emit(this.iten),this.iten={product:this.product,quantity:0,amount:0},this.modal.onCloseHandled()}}return t.\u0275fac=function(e){return new(e||t)(r.Y36(T.M))},t.\u0275cmp=r.Xpm({type:t,selectors:[["app-itens-modal"]],viewQuery:function(t,e){if(1&t&&r.Gf(M,5),2&t){let t;r.iGM(t=r.CRH())&&(e.modal=t.first)}},outputs:{fnSave:"fnSave"},decls:26,vars:5,consts:[["title","Produtos",3,"fnSave"],["modal",""],["body",""],[1,"col-sm-12"],[1,"row"],[1,"col-sm-12","col-md-3"],[1,"form-group"],["for","product"],["id","product",3,"ngModel","ngModelChange","change"],[3,"ngValue",4,"ngFor","ngForOf"],["for","vrUnit"],["id","vrUnit","type","number",3,"ngModel","ngModelChange","change"],["for","qtd"],["id","qtd","type","number",3,"ngModel","ngModelChange","change"],["for","amount"],["id","amount","type","number","disabled","",3,"ngModel","ngModelChange"],[3,"ngValue"]],template:function(t,e){1&t&&(r.TgZ(0,"app-modal",0,1),r.NdJ("fnSave",function(){return e.save()}),r.TgZ(2,"div",2),r.TgZ(3,"div",3),r.TgZ(4,"div",4),r.TgZ(5,"div",5),r.TgZ(6,"div",6),r.TgZ(7,"label",7),r._uU(8,"Produto:"),r.qZA(),r.TgZ(9,"select",8),r.NdJ("ngModelChange",function(t){return e.product=t})("change",function(){return e.refreshItem()}),r.YNc(10,U,2,2,"option",9),r.qZA(),r.qZA(),r.qZA(),r.TgZ(11,"div",5),r.TgZ(12,"div",6),r.TgZ(13,"label",10),r._uU(14,"Vr Unit\xe1rio:"),r.qZA(),r.TgZ(15,"input",11),r.NdJ("ngModelChange",function(t){return e.product.value=t})("change",function(){return e.refreshValues()}),r.qZA(),r.qZA(),r.qZA(),r.TgZ(16,"div",5),r.TgZ(17,"div",6),r.TgZ(18,"label",12),r._uU(19,"Quantidade:"),r.qZA(),r.TgZ(20,"input",13),r.NdJ("ngModelChange",function(t){return e.iten.quantity=t})("change",function(){return e.refreshValues()}),r.qZA(),r.qZA(),r.qZA(),r.TgZ(21,"div",5),r.TgZ(22,"div",6),r.TgZ(23,"label",14),r._uU(24,"Total:"),r.qZA(),r.TgZ(25,"input",15),r.NdJ("ngModelChange",function(t){return e.iten.amount=t}),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA()),2&t&&(r.xp6(9),r.Q6J("ngModel",e.product),r.xp6(1),r.Q6J("ngForOf",e.products),r.xp6(5),r.Q6J("ngModel",e.product.value),r.xp6(5),r.Q6J("ngModel",e.iten.quantity),r.xp6(5),r.Q6J("ngModel",e.iten.amount))},directives:[k,f.EJ,f.JJ,f.On,n.sg,f.wV,f.Fj,f.YN,f.Kr],styles:[".row[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;align-items:center}"]}),t})();var J=o(5574),O=o(8638),I=o(2860);const N=["modalProducts"];function S(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"form",22),r.NdJ("ngSubmit",function(e){return r.CHM(t),r.oxw().onSubmit(),e.preventDefault()}),r.TgZ(1,"div",23),r.TgZ(2,"div",24),r.TgZ(3,"div",25),r.TgZ(4,"div",26),r.TgZ(5,"label",27),r._uU(6,"C\xf3digo"),r.qZA(),r._UZ(7,"input",28),r._UZ(8,"valid-msg",29),r.qZA(),r.qZA(),r.TgZ(9,"div",30),r.TgZ(10,"div",26),r.TgZ(11,"label",31),r._uU(12,"Data/Hora"),r.qZA(),r._UZ(13,"input",32),r._UZ(14,"valid-msg",29),r.qZA(),r.qZA(),r.TgZ(15,"div",33),r.TgZ(16,"div",34),r.TgZ(17,"label",35),r._uU(18,"Cliente"),r.qZA(),r._UZ(19,"input",36),r.qZA(),r._UZ(20,"valid-msg",29),r.qZA(),r.TgZ(21,"div",37),r.TgZ(22,"div",26),r.TgZ(23,"label",38),r._uU(24,"Total do Pedido"),r.qZA(),r._UZ(25,"input",39),r._UZ(26,"valid-msg",29),r.qZA(),r.qZA(),r.qZA(),r._UZ(27,"hr",40),r.qZA(),r._UZ(28,"toolbar-edit",41),r.qZA()}if(2&t){const t=r.oxw();r.Q6J("formGroup",t.formulario),r.xp6(8),r.Q6J("control",t.formulario.controls.cod),r.xp6(6),r.Q6J("control",t.formulario.controls.time),r.xp6(6),r.Q6J("control",t.formulario.controls.customer),r.xp6(6),r.Q6J("control",t.formulario.controls.amount),r.xp6(2),r.Q6J("formulario",t.formulario)}}function P(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"a",47),r.TgZ(1,"button",48),r.NdJ("click",function(){const e=r.CHM(t).$implicit,o=r.oxw().$implicit;return e.eventHandler(o)}),r.qZA(),r.qZA()}if(2&t){const t=e.$implicit;r.xp6(1),r.MT6("btn btn-",t.color," btn-pdr fa fa-",t.icon||"plus"," sombra-btn"),r.s9C("title",t.title)}}function j(t,e){if(1&t&&(r.TgZ(0,"tr"),r.TgZ(1,"td",42),r._uU(2),r.qZA(),r.TgZ(3,"td",43),r._uU(4),r.qZA(),r.TgZ(5,"td",44),r._uU(6),r.ALo(7,"customPipe"),r.qZA(),r.TgZ(8,"td",45),r._uU(9),r.ALo(10,"customPipe"),r.qZA(),r.TgZ(11,"td"),r.YNc(12,P,2,5,"a",46),r.qZA(),r.qZA()),2&t){const t=e.$implicit,o=r.oxw();r.xp6(2),r.Oqu((null==t.product?null:t.product.name)||""),r.xp6(2),r.Oqu(t.quantity||0),r.xp6(2),r.Oqu(r.xi3(7,5,(null==t.product?null:t.product.value)||0,"currency")),r.xp6(3),r.Oqu(r.xi3(10,8,t.amount||0,"currency")),r.xp6(3),r.Q6J("ngForOf",o.tableOptions.buttons)}}function Q(t,e){if(1&t&&(r.TgZ(0,"td",49),r._uU(1),r.qZA()),2&t){const t=r.oxw();r.xp6(1),r.hij(" ",t.tableOptions.emptyMessage,"")}}let F=(()=>{class t extends Z.R{constructor(t,e,o){super(t,e,"orders","/orders"),this.injector=t,this.orderService=e,this.customerService=o,this.customer={id:null,address:null,birthday:null,cpf:"",email:"",name:""},this.itens=[],this.tableOptions={entity:this.itens,fields:[{name:"name",label:"Nome",pipe:"uppercase"},{name:"email",label:"E-mail",pipe:"lowerCase"},{name:"cpf",label:"CPF"}],headers:["Nome","E-mail","CPF"],emptyMessage:"Nenhum Registro encontrado",buttons:[{eventHandler:t=>this.goToEdit(t.id),title:"Editar",color:s.s.PRIMARY,icon:s.E.EDIT},{eventHandler:t=>this.removeIten(t),title:"Deletar",color:s.s.DANGER,icon:s.E.TRASH}]}}formConstructorById(){var t=this;return(0,g.Z)(function*(){return t.formBuilder.group({id:[t.object.id],cod:[{value:t.object.cod,disabled:!0},[f.kI.required,f.kI.minLength(3)]],time:[{value:t.object.time,disabled:!0}],customer:t.formBuilder.group({id:[t.object.customer.id],name:[{value:t.object.customer.name,disabled:!0},[f.kI.required,f.kI.minLength(3)]],email:[t.object.customer.email,[f.kI.required,f.kI.email]],cpf:[t.object.customer.cpf,[f.kI.required]],birthday:[new Date(t.object.customer.birthday).toISOString().substr(0,10)]}),products:[t.object.products],amount:[t.object.amount]})})()}formConstructorNew(){var t=this;return(0,g.Z)(function*(){return t.formBuilder.group({id:[null],cod:[{value:(new Date).valueOf(),disabled:!0},[f.kI.required,f.kI.minLength(3)]],time:[{value:`${(new Date).toISOString().substr(0,10)} - ${(new Date).getHours()}:${(new Date).getMinutes()}`,disabled:!0}],customer:t.formBuilder.group({id:[""],name:[{value:"",disabled:!0},[f.kI.required,f.kI.minLength(3)]],email:["",[f.kI.required,f.kI.email]],cpf:["",[f.kI.required]],birthday:[""]}),products:[[]],amount:[0]})})()}guardListAttrib(){var t=this;return(0,g.Z)(function*(){t.customer=t.object.customer,t.itens=t.object.products})()}returnListAttrib(){var t=this;return(0,g.Z)(function*(){t.object.customer=t.customer,t.object.products=t.itens})()}findCustomerByCpf(t){this.customerService.getByCPF(t).pipe((0,b.q)(1)).subscribe(t=>{this.customer=t[0],this.formulario.patchValue({customer:this.customer})})}goToEdit(t){}openModalProduct(){this.modalproducts.open()}addIten(t){this.itens.push(t),this.refreshItens(this.itens)}removeIten(t){this.itens.splice(this.itens.indexOf(this.checkIten(t)),1),this.refreshItens(this.itens)}checkIten(t){return this.itens.find(e=>e.product.id===t.product.id)}refreshItens(t){let e=0;for(let o of t)e+=o.amount;this.formulario.patchValue({amount:e}),this.onSubmit()}listFactory(){}}return t.\u0275fac=function(e){return new(e||t)(r.Y36(r.zs3),r.Y36(c),r.Y36(h.v))},t.\u0275cmp=r.Xpm({type:t,selectors:[["app-order-edit"]],viewQuery:function(t,e){if(1&t&&r.Gf(N,5),2&t){let t;r.iGM(t=r.CRH())&&(e.modalproducts=t.first)}},features:[r.qOj],decls:47,vars:4,consts:[[1,"card"],[1,"page-top","shadow-sm"],["title","voltar",1,"btn","btn-warning","btn-xs","btn-pdr","fas","fa-arrow-circle-left","float-right","sombra-btn",3,"click"],[1,"card-body"],["itens","",1,"search"],["for","cpf",1,"searchLabel"],["id","cpf","type","text","IkMask","999.999.999-99",1,"border-r","border-l"],["cpf",""],[1,"btn","btn-primary",3,"click"],[1,"fas","fa-search"],["id","nome","type","text","disabled","",1,"border-r","border-l",3,"ngModel","ngModelChange"],["itens","",1,"col-xs-12","col-md-12"],[3,"formGroup","ngSubmit",4,"ngIf"],["itens",""],[1,"options"],[1,"fas","fa-receipt"],[1,"scrolling"],[1,"table","table-striped","table-bordered","table-sm"],[4,"ngFor","ngForOf"],["colspan","5","class","table-message-empty",4,"ngIf"],[3,"fnSave"],["modalProducts",""],[3,"formGroup","ngSubmit"],[1,"col-xs-12"],[1,"row"],[1,"col-sm-12","col-md-3"],[1,"form-group"],["for","cod"],["id","cod","type","text","formControlName","cod","IkUpCase","",1,"form-control"],[3,"control"],[1,"col-xs-12","col-md-3"],["for","time"],["id","time","type","text","formControlName","time",1,"form-control"],[1,"col-xs-12","col-md-4"],["formGroupName","customer",1,"form-group"],["for","customer"],["id","customer","type","text","formControlName","name",1,"form-control"],[1,"col-xs-12","col-md-2"],["for","amount"],["id","amount","type","number","formControlName","amount",1,"form-control"],[2,"margin","2px"],[3,"formulario"],["attr.data-label","Produto"],["attr.data-label","Quantidade"],["attr.data-label","Vr_Unit\xe1rio"],["attr.data-label","Total"],["class","componenteform",4,"ngFor","ngForOf"],[1,"componenteform"],["type","button","data-placement","bottom",3,"title","click"],["colspan","5",1,"table-message-empty"]],template:function(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"div",0),r.TgZ(1,"div",1),r._uU(2," Cadastro de Pedido "),r.TgZ(3,"button",2),r.NdJ("click",function(){return e.return()}),r.qZA(),r.qZA(),r.TgZ(4,"div",3),r.TgZ(5,"toolbar-base"),r.TgZ(6,"div",4),r.TgZ(7,"label",5),r._uU(8,"CPF:"),r.qZA(),r._UZ(9,"input",6,7),r.TgZ(11,"button",8),r.NdJ("click",function(){r.CHM(t);const o=r.MAs(10);return e.findCustomerByCpf(o.value)}),r._UZ(12,"i",9),r.qZA(),r.TgZ(13,"label",5),r._uU(14,"Cliente:"),r.qZA(),r.TgZ(15,"input",10),r.NdJ("ngModelChange",function(t){return e.customer.name=t}),r.qZA(),r.qZA(),r.qZA(),r._UZ(16,"hr"),r.TgZ(17,"toolbar-base"),r.TgZ(18,"div",11),r.YNc(19,S,29,6,"form",12),r.qZA(),r.qZA(),r._UZ(20,"hr"),r.TgZ(21,"toolbar-base"),r.TgZ(22,"div",13),r.TgZ(23,"div",14),r.TgZ(24,"button",8),r.NdJ("click",function(){return e.openModalProduct()}),r._uU(25," Novo Item "),r._UZ(26,"i",15),r.qZA(),r.qZA(),r.TgZ(27,"div",16),r.TgZ(28,"table",17),r.TgZ(29,"thead"),r.TgZ(30,"tr"),r.TgZ(31,"th"),r._uU(32,"Produto"),r.qZA(),r.TgZ(33,"th"),r._uU(34,"Quantidade"),r.qZA(),r.TgZ(35,"th"),r._uU(36,"Vr_Unit"),r.qZA(),r.TgZ(37,"th"),r._uU(38,"Vr_Total"),r.qZA(),r.TgZ(39,"th"),r._uU(40,"Op\xe7\xf5es"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(41,"tbody"),r.YNc(42,j,13,11,"tr",18),r.TgZ(43,"tr"),r.YNc(44,Q,2,1,"td",19),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.TgZ(45,"app-itens-modal",20,21),r.NdJ("fnSave",function(t){return e.addIten(t)}),r.qZA()}2&t&&(r.xp6(15),r.Q6J("ngModel",e.customer.name),r.xp6(4),r.Q6J("ngIf",void 0!==e.formulario),r.xp6(23),r.Q6J("ngForOf",e.itens),r.xp6(2),r.Q6J("ngIf",e.itens.length<1))},directives:[v.T,q.J,f.Fj,f.JJ,f.On,n.O5,n.sg,w,f._Y,f.JL,f.sg,f.u,J.p,f.x0,f.wV,O.Z],pipes:[I.G],styles:[".search[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;align-items:center}.searchLabel[_ngcontent-%COMP%]{font-weight:700}.options[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;align-items:center}"]}),t})();const H=[{path:"",component:a},{path:"list",component:m},{path:"list/:id/add",component:F},{path:":id/add",component:F},{path:":id/edit",component:F}];let E=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=r.oAB({type:t}),t.\u0275inj=r.cJS({imports:[[i.Bz.forChild(H)],i.Bz]}),t})();var Y=o(4726),V=o(5642);let B=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=r.oAB({type:t}),t.\u0275inj=r.cJS({imports:[[Y.p,V.K,n.ez,E]]}),t})()}}]);